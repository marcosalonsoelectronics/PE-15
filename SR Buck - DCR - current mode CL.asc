Version 4
SHEET 1 2312 1172
WIRE 144 16 112 16
WIRE 272 16 144 16
WIRE 544 16 368 16
WIRE 592 16 544 16
WIRE 752 16 592 16
WIRE 912 16 752 16
WIRE 1168 16 992 16
WIRE 1616 16 1168 16
WIRE 1744 16 1616 16
WIRE 1760 16 1744 16
WIRE 2032 16 1760 16
WIRE 1760 96 1760 16
WIRE 592 112 592 16
WIRE 752 112 752 16
WIRE 800 112 752 112
WIRE 944 112 880 112
WIRE 992 112 944 112
WIRE 1088 112 1056 112
WIRE 1168 112 1168 16
WIRE 1168 112 1088 112
WIRE 1616 112 1616 16
WIRE 112 128 112 16
WIRE 304 128 256 128
WIRE 352 128 352 64
WIRE 352 128 304 128
WIRE 480 192 432 192
WIRE 544 192 480 192
WIRE 896 192 784 192
WIRE 944 192 944 112
WIRE 944 192 896 192
WIRE 1616 208 1616 176
WIRE 1088 256 1088 112
WIRE 1088 256 848 256
WIRE 112 336 112 208
WIRE 592 336 592 208
WIRE 592 336 112 336
WIRE 1616 336 1616 288
WIRE 1616 336 592 336
WIRE 1760 336 1760 176
WIRE 1760 336 1616 336
WIRE 112 384 112 336
WIRE 1056 400 880 400
WIRE 1360 400 1312 400
WIRE 1488 400 1440 400
WIRE 880 448 880 400
WIRE 928 448 880 448
WIRE 1056 464 1056 400
WIRE 1056 464 992 464
WIRE 1152 464 1056 464
WIRE 848 480 848 256
WIRE 928 480 848 480
WIRE 1152 480 1152 464
WIRE 1184 480 1152 480
WIRE 1312 480 1312 400
WIRE 1312 480 1264 480
WIRE 1360 480 1312 480
WIRE 1488 496 1488 400
WIRE 1488 496 1424 496
WIRE 1584 496 1488 496
WIRE 1616 496 1584 496
WIRE 464 512 336 512
WIRE 624 512 544 512
WIRE 656 512 624 512
WIRE 1360 512 1312 512
WIRE 160 528 48 528
WIRE 624 544 336 544
WIRE 656 544 624 544
WIRE 1040 544 848 544
WIRE 160 560 128 560
WIRE 464 576 336 576
WIRE 624 576 544 576
WIRE 656 576 624 576
WIRE 1184 576 1152 576
WIRE 1312 576 1312 512
WIRE 1312 576 1264 576
WIRE 128 608 128 560
WIRE 160 608 128 608
WIRE 400 608 336 608
WIRE 848 608 848 544
WIRE 928 608 848 608
WIRE 1040 624 1040 544
WIRE 1040 624 992 624
WIRE 1152 624 1152 576
WIRE 1152 624 1040 624
WIRE 784 640 784 192
WIRE 928 640 784 640
WIRE 1312 640 1312 576
WIRE 400 656 400 608
WIRE 128 720 128 608
WIRE 1488 720 1376 720
WIRE 1488 736 1488 720
WIRE 1312 752 1312 720
WIRE 1744 832 1664 832
WIRE 1872 832 1808 832
WIRE 1488 848 1488 816
WIRE 1376 880 1376 720
WIRE 1616 880 1616 496
WIRE 1616 880 1408 880
WIRE 1232 896 944 896
WIRE 1344 896 1232 896
WIRE 1872 896 1872 832
WIRE 1872 896 1840 896
WIRE 1920 896 1872 896
WIRE 2032 896 2032 16
WIRE 2032 896 2000 896
WIRE 1616 912 1408 912
WIRE 1664 912 1664 832
WIRE 1664 912 1616 912
WIRE 1776 912 1664 912
WIRE 1920 928 1840 928
WIRE 48 944 48 528
WIRE 624 944 48 944
WIRE 848 944 624 944
WIRE 1152 944 944 944
WIRE 1376 976 1376 912
WIRE 1920 976 1920 928
WIRE 1968 976 1920 976
WIRE 2128 976 2048 976
WIRE 1152 992 1152 944
WIRE 2128 1008 2128 976
WIRE 1920 1024 1920 976
WIRE 1152 1136 1152 1072
WIRE 1920 1136 1920 1088
WIRE 2128 1136 2128 1088
FLAG 112 384 0
FLAG 304 128 gate1
FLAG 544 16 source
FLAG 144 16 in
FLAG 1744 16 out
FLAG 480 192 gate2
FLAG 1152 1136 0
FLAG 128 720 0
FLAG 400 656 0
FLAG 624 512 gate1
FLAG 624 544 source
FLAG 624 576 gate2
FLAG 896 192 +s
FLAG 1312 752 0
FLAG 1584 496 s1
FLAG 1376 976 0
FLAG 1488 848 0
FLAG 1232 896 comp
FLAG 2128 1136 0
FLAG 624 944 pwm
FLAG 1616 912 err
FLAG 1920 1136 0
SYMBOL nmos 272 64 R270
WINDOW 0 71 26 VRight 2
WINDOW 3 31 -96 VRight 2
SYMATTR InstName M1
SYMATTR Value IRFZ48Z
SYMBOL voltage 112 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vi
SYMATTR Value 12
SYMBOL ind 896 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {L}
SYMATTR SpiceLine Rser={r_L}
SYMBOL cap 1600 112 R0
SYMATTR InstName C1
SYMATTR Value 75µ
SYMBOL res 1744 80 R0
SYMATTR InstName RL
SYMATTR Value 0.25
SYMBOL voltage 1152 976 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 14 121 Left 2
SYMATTR Value PULSE(0 5 0 10n 10n {0.1/f} {1/f})
SYMATTR InstName Vpulse
SYMBOL res 1632 304 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Resr
SYMATTR Value 10m
SYMBOL nmos 544 112 R0
WINDOW 0 89 44 Right 2
WINDOW 3 160 77 Right 2
SYMATTR InstName M2
SYMATTR Value IRFZ48Z
SYMBOL MyDriverHB 272 560 R0
WINDOW 3 -66 104 Bottom 2
WINDOW 123 -51 134 Bottom 2
WINDOW 0 -91 -106 Bottom 2
WINDOW 38 -37 -76 Bottom 2
SYMATTR Value2 Tau=120n
SYMATTR InstName U1
SYMBOL res 560 496 R90
WINDOW 0 7 119 VBottom 2
WINDOW 3 -15 7 VTop 2
SYMATTR InstName Rg1
SYMATTR Value 5
SYMBOL res 560 560 R90
WINDOW 0 51 112 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rg2
SYMATTR Value 5
SYMBOL res 784 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL cap 1056 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL MyOpamp 1392 496 M180
WINDOW 39 67 -109 Center 2
WINDOW 40 77 -75 Center 2
SYMATTR SpiceLine2 Ao=1e5 FBW=4e6
SYMATTR InstName U2
SYMBOL res 1280 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res 1280 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 1456 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 5k
SYMBOL res 1328 736 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 5k
SYMBOL MyOpamp 960 464 M180
WINDOW 39 85 -55 Center 2
WINDOW 40 104 -31 Center 2
WINDOW 0 3 33 Left 2
SYMATTR InstName U3
SYMBOL MyOpamp 960 624 M180
WINDOW 39 55 -77 Center 2
WINDOW 40 72 -50 Center 2
WINDOW 0 1 34 Left 2
SYMATTR InstName U4
SYMBOL MyComparator 1376 896 M0
WINDOW 0 22 -34 Left 2
WINDOW 38 11 -61 Left 2
SYMATTR InstName U5
SYMBOL voltage 1488 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL MyOpamp 1808 912 R180
WINDOW 39 70 -45 Center 2
WINDOW 40 53 -67 Center 2
WINDOW 0 32 -23 Left 2
SYMATTR InstName U8
SYMBOL cap 1808 816 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL res 2016 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL voltage 2128 992 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL cap 1904 1024 R0
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL res 2064 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 4.7k
SYMBOL Digital\\srflop 896 992 R180
SYMATTR InstName A2
TEXT 440 -72 Left 2 !.param f=100k
TEXT 920 -80 Left 2 !.tran 5m uic
TEXT 688 -80 Left 2 !.param L 8u\n.param r_L 10m
TEXT 1128 -72 Left 2 ;L nominal: 10 uH
TEXT 152 -72 Left 2 !.options reltol 1m
TEXT 1520 456 Left 2 ;Gain: 1 V  ~  20 A
TEXT 2184 1040 Left 2 ;Reference \nVoltage
TEXT 1952 1112 Left 2 ;SOFT START
TEXT 1736 1016 Left 2 ;Error\nCompensator
